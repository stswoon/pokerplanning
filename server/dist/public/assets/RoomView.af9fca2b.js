import{d as _,_ as h,o as n,c as r,a as o,n as w,f as B,p as N,g as S,t as C,b as I,F as p,h as m,i as g,j as l,e as $,r as k}from"./index.8ec967d7.js";import{r as u,u as V}from"./room.service.0fddc71d.js";const D=_({props:["cardShirt","rotateAngle","value","nonVisible","showAnimation","flipCardAnimation"],data:function(){return{showAnimationState:this.showAnimation}},computed:{displayText:function(){return this.value===.5?"&half;":this.value}},watch:{value:function(e,s){if(e!=s){const a=this.showAnimationState==="UP"?"_run-transformation-up":"_run-transformation-down",i=this.$el;i.classList.remove(a),i.offsetWidth,i.classList.add(a)}}}});const R=e=>(N("data-v-cec2be46"),e=e(),S(),e),L={class:"flip-card-inner"},F=R(()=>o("div",{class:"flip-card-back"},[o("img")],-1)),P={class:"flip-card-front"},O=["innerHTML"];function W(e,s,a,i,f,b){return n(),r("div",{class:w(["card-container",{"_run-transformation-up":this.showAnimationState==="UP","_run-transformation-down":this.showAnimationState==="DOWN","_run-flip-animation":e.flipCardAnimation}])},[o("div",{class:w(["flip-card card",{"_non-visible":e.nonVisible,"flip-card-show":e.cardShirt}]),style:B({transform:`rotate(${e.rotateAngle}deg)`})},[o("div",L,[F,o("div",P,[o("span",{innerHTML:e.displayText},null,8,O)])])],6)],2)}const A=h(D,[["render",W],["__scopeId","data-v-cec2be46"]]),j="/assets/u1.5cab49a1.png",M="/assets/u2.9124d0ae.png",q="/assets/u3.b92d06b8.png",z="/assets/u4.9cbaa497.png",E="/assets/u5.50729001.png",H="/assets/u3.b92d06b8.png",Q="/assets/u2.9124d0ae.png",G="/assets/u8.45c59d43.png",J=_({props:["userName","display","displayName","order"],computed:{backgroundImage:function(){const e=new URL(Object.assign({"./icons/u1.png":j,"./icons/u2.png":M,"./icons/u3.png":q,"./icons/u4.png":z,"./icons/u5.png":E,"./icons/u6.png":H,"./icons/u7.png":Q,"./icons/u8.png":G})[`./icons/u${this.order}.png`],self.location).href;return"url("+e+")"}}});const K={key:0,class:"user-name"},X={key:1,class:"user-name"};function Y(e,s,a,i,f,b){return n(),r("div",{class:w(["user-container",{"user-in-line":e.display==="line"}])},[e.displayName==="up"?(n(),r("div",K,C(e.userName),1)):I("",!0),o("div",{class:"user",style:B([{"'q":"q'"},{"background-image":e.backgroundImage}])},null,4),e.displayName==="down"||e.display==="line"?(n(),r("div",X,C(e.userName),1)):I("",!0)],2)}const U=h(J,[["render",Y],["__scopeId","data-v-038839c4"]]),Z=_({components:{User:U},emits:["clearCards","flipCards","changeName"],props:{votes:{type:Array,default:[]},showCards:{type:Boolean,default:!1}},methods:{cardValueDisplay:function(e){return this.showCards?e.cardValue==null?"no card":e.cardValue:e.cardValue==null?"waiting":"??"}},computed:{average:function(){const e=this.votes.filter(a=>typeof a.cardValue=="number");let s=e.reduce((a,i)=>a+i.cardValue,0);return s=s/e.length,s=Math.round(s*10)/10,s}}});const v=e=>(N("data-v-bb030d73"),e=e(),S(),e),x={class:"scoreboard"},ee=v(()=>o("hr",null,null,-1)),se={class:"average"},oe=v(()=>o("hr",null,null,-1)),ae={class:"scoreboard__user-line"},ne=v(()=>o("span",null,":\xA0",-1)),te=v(()=>o("hr",null,null,-1)),re=v(()=>o("hr",null,null,-1)),de=v(()=>o("div",{class:"donate"},[o("a",{href:"https://yoomoney.ru/to/41001998657825"},"Donate Thanks")],-1));function ie(e,s,a,i,f,b){const c=l("User");return n(),r("div",x,[o("button",{onClick:s[0]||(s[0]=d=>this.$emit("clearCards"))},"Clear cards"),o("button",{onClick:s[1]||(s[1]=d=>this.$emit("flipCards"))},"Flip cards"),ee,o("div",se,"Average: "+C(e.showCards?e.average:"??"),1),oe,o("div",null,[(n(!0),r(p,null,m(e.votes,(d,t)=>(n(),r("div",ae,[o("span",null,[g(c,{"user-name":d.userName,display:"line",order:t+1},null,8,["user-name","order"])]),ne,o("span",null,C(e.cardValueDisplay(d)),1)]))),256))]),te,o("button",{onClick:s[2]||(s[2]=d=>this.$emit("changeName"))},"Change name"),re,de])}const ce=h(Z,[["render",ie],["__scopeId","data-v-bb030d73"]]),le=_({components:{Card:A,User:U},props:["votes","showCards"],computed:{voteUp:function(){let e=this.votes.map((s,a)=>(s.order=a+1,s));return e=e.filter((s,a)=>a%2===0),e},voteDown:function(){let e=this.votes.map((s,a)=>(s.order=a+1,s));return e=e.filter((s,a)=>a%2!==0),e}}});const T=e=>(N("data-v-e9b216fa"),e=e(),S(),e),_e={class:"table-container"},ue={class:"table-bench",id:"bench-up"},pe={class:"table"},me=T(()=>o("div",{class:"table__left"},null,-1)),he={class:"table__middle"},ve={class:"table__middle-up"},fe={class:"table__middle-down"},be=T(()=>o("div",{class:"table__right"},null,-1)),$e={class:"table-bench",id:"bench-down"};function ge(e,s,a,i,f,b){const c=l("User"),d=l("Card");return n(),r("div",_e,[o("div",ue,[(n(!0),r(p,null,m(e.voteUp,t=>(n(),$(c,{userName:t.userName,"display-name":"up",order:t.order},null,8,["userName","order"]))),256))]),o("div",pe,[me,o("div",he,[o("div",ve,[(n(!0),r(p,null,m(e.voteUp,t=>(n(),$(d,{value:t.cardValue,rotateAngle:t.rotateAngle,cardShirt:!e.showCards,"non-visible":t.cardValue==null,"show-animation":"DOWN"},null,8,["value","rotateAngle","cardShirt","non-visible"]))),256))]),o("div",fe,[(n(!0),r(p,null,m(e.voteDown,t=>(n(),$(d,{value:t.cardValue,rotateAngle:t.rotateAngle,cardShirt:!e.showCards,"non-visible":t.cardValue==null,"show-animation":"UP"},null,8,["value","rotateAngle","cardShirt","non-visible"]))),256))])]),be]),o("div",$e,[(n(!0),r(p,null,m(e.voteDown,t=>(n(),$(c,{userName:t.userName,"display-name":"down",order:t.order},null,8,["userName","order"]))),256))])])}const Ce=h(le,[["render",ge],["__scopeId","data-v-e9b216fa"]]);let y=[0,.5,1,2,3,4,5,6,7,8,9,10,12,15,30,"?"];y=y.map(e=>({value:e,cardBack:!0}));const we=_({components:{Card:A},emits:["throwCard"],data(){return{avCards:y}},mounted(){this.avCards.forEach((e,s)=>{setTimeout(()=>e.cardBack=!1,1e3+s*100)})}});const ye={class:"card-board"},Ne=["onClick"];function Se(e,s,a,i,f,b){const c=l("Card");return n(),r("div",ye,[(n(!0),r(p,null,m(e.avCards,d=>(n(),r("button",{class:"card",onClick:t=>this.$emit("throwCard",d.value)},[g(c,{value:d.value,"card-shirt":d.cardBack},null,8,["value","card-shirt"])],8,Ne))),256))])}const Ae=h(we,[["render",Se],["__scopeId","data-v-ec470b21"]]),Ie=_({components:{CardBoard:Ae,Table:Ce,ScoreBoard:ce,Card:A},data(){return{votes:[],showCards:!1}},methods:{throwCard:function(e){u.throwCard(e)},clearCards:function(){u.clearCards()},flipCards:function(){u.flipCards()},changeName:function(){u.setUserName("");const e=V.getQueryParameter("roomId");k.push(`/?redirectRoomId=${e}`)}},mounted(){if(u.getUserName())u.attachWsToRoom(s=>{this.votes=Object.values(s.votes),this.showCards=s.showCards});else{const s=V.getQueryParameter("roomId");k.push(`/?redirectRoomId=${s}`)}}});const ke={class:"room-container"},Ve={class:"room-container__table"},Be={class:"room-container__card-board"},Ue={class:"room-container__score-board"};function Te(e,s,a,i,f,b){const c=l("Table"),d=l("CardBoard"),t=l("ScoreBoard");return n(),r("div",ke,[o("div",Ve,[g(c,{votes:e.votes,"show-cards":e.showCards},null,8,["votes","show-cards"])]),o("div",Be,[g(d,{onThrowCard:e.throwCard},null,8,["onThrowCard"])]),o("div",Ue,[g(t,{votes:e.votes,"show-cards":e.showCards,onClearCards:e.clearCards,onFlipCards:e.flipCards,onChangeName:e.changeName},null,8,["votes","show-cards","onClearCards","onFlipCards","onChangeName"])])])}const De=h(Ie,[["render",Te],["__scopeId","data-v-0bc86348"]]),Fe=_({__name:"RoomView",setup(e){return(s,a)=>(n(),$(De))}});export{Fe as default};
//# sourceMappingURL=RoomView.af9fca2b.js.map
